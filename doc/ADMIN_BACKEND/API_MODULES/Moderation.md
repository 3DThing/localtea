# Модуль Moderation (Admin)

Управление комментариями, жалобами и баном пользователей.
Базовый префикс для всех маршрутов: `/api/v1/moderation`.

## Комментарии (Comments)

### `GET /comments`

*   **Описание**: Получить список комментариев для модерации.
*   **Требования**: Права администратора.
*   **Параметры запроса**:
    *   `skip` (int, default=0): Пропустить N записей.
    *   `limit` (int, default=50, max=200): Лимит записей.
    *   `user_id` (int, optional): Фильтр по автору.
    *   `article_id` (int, optional): Фильтр по статье.
    *   `product_id` (int, optional): Фильтр по товару.
    *   `has_reports` (bool, optional): Только комментарии с жалобами.
    *   `q` (string, optional): Поиск по тексту комментария.
*   **Ответ**: `CommentListResponse` со списком комментариев и информацией об авторах.

### `DELETE /comments/{comment_id}`

*   **Описание**: Удалить комментарий.
*   **Требования**: Права администратора.
*   **Параметры**: `comment_id` (Integer).
*   **Действия**:
    *   Удаляет связанные жалобы.
    *   Удаляет комментарий.
    *   Записывает действие в аудит лог.
*   **Ответ**: `{"message": "Comment deleted"}`.

---

## Жалобы (Reports)

### `GET /reports`

*   **Описание**: Получить список жалоб на комментарии.
*   **Требования**: Права администратора.
*   **Параметры запроса**:
    *   `skip` (int, default=0): Пропустить N записей.
    *   `limit` (int, default=50, max=200): Лимит записей.
    *   `status` (string, optional): Фильтр по статусу (`new`, `resolved`, `rejected`).
*   **Ответ**: `ReportListResponse` со списком жалоб и информацией о комментариях.

### `POST /reports/{report_id}/resolve`

*   **Описание**: Обработать жалобу.
*   **Требования**: Права администратора.
*   **Параметры**: `report_id` (Integer).
*   **Тело запроса**: `ReportResolve`
    *   `action` (string): Действие — `resolve`, `reject`, или `delete_comment`.
    *   `note` (string, optional): Примечание администратора.
*   **Действия**:
    *   `resolve` — Жалоба признана обоснованной.
    *   `reject` — Жалоба отклонена.
    *   `delete_comment` — Комментарий удаляется, жалоба закрывается.
*   **Ответ**: Обновлённый объект жалобы.

---

## Бан пользователей (User Bans)

### `POST /users/{user_id}/ban`

*   **Описание**: Заблокировать пользователя.
*   **Требования**: Права администратора.
*   **Параметры**: `user_id` (Integer).
*   **Тело запроса**: `UserBan`
    *   `reason` (string): Причина блокировки.
    *   `duration_hours` (int, optional): Длительность в часах (null = бессрочно).
*   **Действия**:
    *   Устанавливает `is_active=False` для пользователя.
    *   Записывает причину и срок блокировки.
    *   Записывает действие в аудит лог.
*   **Ответ**: `{"message": "User banned"}`.

### `POST /users/{user_id}/unban`

*   **Описание**: Разблокировать пользователя.
*   **Требования**: Права администратора.
*   **Параметры**: `user_id` (Integer).
*   **Действия**:
    *   Устанавливает `is_active=True` для пользователя.
    *   Записывает действие в аудит лог.
*   **Ответ**: `{"message": "User unbanned"}`.

### `GET /users/banned`

*   **Описание**: Получить список заблокированных пользователей.
*   **Требования**: Права администратора.
*   **Параметры запроса**:
    *   `skip` (int, default=0): Пропустить N записей.
    *   `limit` (int, default=50): Лимит записей.
*   **Ответ**: Список заблокированных пользователей с причинами блокировки.

---

## Статусы жалоб

| Статус | Описание |
|--------|----------|
| `new` | Новая, ожидает рассмотрения |
| `resolved` | Рассмотрена, признана обоснованной |
| `rejected` | Отклонена |
