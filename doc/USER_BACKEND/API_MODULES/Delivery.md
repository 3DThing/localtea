# API Маршруты (Endpoints) модуля Delivery

В этом документе описаны маршруты API для расчёта стоимости доставки.
Базовый префикс для всех маршрутов: `/api/v1/delivery`.

## Расчёт доставки

### `POST /calculate`

*   **Описание**: Рассчитать стоимость доставки Почтой России.
*   **Тело запроса**: `DeliveryCalculateRequest`:
    *   `postal_code` (string): Индекс получателя (6 цифр).
    *   `weight_grams` (int): Вес отправления в граммах (1-50000).
*   **Ответ**: `DeliveryCalculateResponse`:
    *   `options` (array): Список вариантов доставки с тарифами.
    *   `cheapest` (object): Самый дешёвый вариант.
*   **Ошибки**: `400` — Не удалось рассчитать доставку (некорректный индекс).

### `GET /methods`

*   **Описание**: Получить список доступных методов доставки.
*   **Ответ**: `DeliveryMethodsResponse`:
    *   `methods` (array): Список методов с описанием.

---

## Методы доставки

| ID | Название | Описание | Стоимость |
|----|----------|----------|-----------|
| `pickup` | Самовывоз | Забрать заказ по адресу магазина | Бесплатно |
| `russian_post` | Почта России | Доставка по всей России | Рассчитывается по индексу |

---

## Интеграция с Почтой России

### API тарификации

Сервис использует официальный API Почты России для расчёта тарифов:
`https://tariff.pochta.ru/v2/calculate/tariff`

### Типы отправлений

| Код | Название | Скорость |
|-----|----------|----------|
| 27030 | Посылка стандарт | 5-10 дней |
| 47030 | Посылка 1-го класса | 2-5 дней |
| 7030 | EMS | 1-3 дня |

### Параметры расчёта

*   Индекс отправителя: Берётся из настроек приложения (`SENDER_POSTAL_CODE`).
*   Индекс получателя: Указывается клиентом.
*   Вес: Рассчитывается из веса товаров в корзине.
*   Объявленная ценность: Равна сумме заказа.

---

## Структура варианта доставки

Каждый вариант в массиве `options` содержит:
*   `mail_type` (string): Код типа отправления.
*   `mail_type_name` (string): Название типа отправления.
*   `total_cost` (float): Стоимость в рублях.
*   `total_cost_cents` (int): Стоимость в копейках.
*   `delivery_min_days` (int): Минимальный срок доставки.
*   `delivery_max_days` (int): Максимальный срок доставки.
